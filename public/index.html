<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SolForge üî• - Universal Solana Transaction Builder</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@solana/web3.js@1.98.0/lib/index.iife.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'ui-sans-serif', 'system-ui'],
                        'mono': ['JetBrains Mono', 'ui-monospace', 'monospace'],
                    },
                    colors: {
                        'primary': {
                            50: '#f0fdf4',
                            500: '#10b981',
                            600: '#059669',
                            700: '#047857',
                        },
                        'accent': '#06d6a0',
                        'cyan': {
                            400: '#22d3ee',
                            500: '#06b6d4',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'pulse-soft': 'pulseSoft 3s ease-in-out infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        pulseSoft: {
                            '0%, 100%': { opacity: '0.4' },
                            '50%': { opacity: '0.8' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
        }
        .gradient-text {
            background: linear-gradient(135deg, #06d6a0 0%, #22d3ee 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            padding-bottom: 0.1em;
            line-height: 1.2;
        }
        .gradient-border {
            background: linear-gradient(135deg, #06d6a0, #22d3ee);
            padding: 1px;
            border-radius: 0.75rem;
        }
        .gradient-border-content {
            background: rgb(30 41 59);
            border-radius: 0.625rem;
        }
        .code-highlight {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .mono {
            font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Consolas, monospace;
        }
    </style>
</head>
<body class="bg-slate-900 text-white font-sans overflow-x-hidden">
    <!-- Hero Section -->
    <section class="min-h-screen gradient-bg flex items-center justify-center relative overflow-hidden">
        <!-- Background elements -->
        <div class="absolute inset-0 bg-gradient-to-r from-emerald-500/10 via-transparent to-cyan-500/10 animate-pulse-soft"></div>
        <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-emerald-500/5 rounded-full blur-3xl animate-pulse-soft"></div>
        <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-cyan-500/5 rounded-full blur-3xl animate-pulse-soft"></div>
        
        <div class="container mx-auto px-6 relative z-10">
            <div class="text-center animate-fade-in">
                <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold mb-6 gradient-text">
                    SolForge üî•
                </h1>
                <h2 class="text-2xl md:text-3xl lg:text-4xl font-medium mb-6 text-slate-200">
                    Natural Language ‚Üí Solana Transactions
                </h2>
                <p class="text-lg md:text-xl text-slate-300 max-w-3xl mx-auto mb-12 leading-relaxed">
                    The universal Solana transaction builder powered by AI. Transform natural language into executable transactions across 12+ protocols. Built for developers, agents, and the future of blockchain interaction.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                    <a href="#demo" class="inline-flex items-center px-8 py-4 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white font-semibold rounded-xl transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-emerald-500/25">
                        <span>Try Interactive Demo</span>
                        <svg class="ml-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                        </svg>
                    </a>
                    <a href="#api" class="inline-flex items-center px-8 py-4 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-emerald-500 text-white font-semibold rounded-xl transition-all duration-300 hover:scale-105">
                        <span>View API Docs</span>
                        <svg class="ml-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Demo Section -->
    <section id="demo" class="py-20 bg-slate-800">
        <div class="container mx-auto px-6">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 text-white">Interactive Demo</h2>
                <p class="text-lg text-slate-300 max-w-2xl mx-auto">
                    Experience the power of natural language blockchain interactions. Connect your wallet and try real Solana operations with simple English commands.
                </p>
            </div>
            
            <div class="max-w-4xl mx-auto">
                <div class="bg-slate-900 rounded-2xl border border-slate-700 p-8 shadow-2xl">
                    <div class="space-y-6">
                        <!-- Natural Language Input -->
                        <div class="space-y-3">
                            <label class="block text-sm font-medium text-slate-200">Natural Language Prompt</label>
                            <div class="relative">
                                <textarea 
                                    id="prompt-input" 
                                    class="w-full h-32 px-4 py-3 bg-slate-800 border border-slate-600 rounded-xl text-white placeholder-slate-400 font-mono text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent resize-none transition-all duration-200"
                                    placeholder="e.g., Transfer 0.5 SOL to 7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU"
                                ></textarea>
                                <div class="absolute bottom-3 right-3 text-xs text-slate-500">
                                    Ctrl+Enter to build
                                </div>
                            </div>
                        </div>

                        <!-- Example Prompts -->
                        <div class="space-y-3">
                            <p class="text-sm text-slate-400 flex items-center">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                Try an example prompt:
                            </p>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                <button class="text-left p-3 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-emerald-500 rounded-lg text-sm text-slate-300 hover:text-white font-mono transition-all duration-200 hover-lift" onclick="setExample('Ape 2 SOL into DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263')">
                                    <span class="text-orange-400">üî•</span> Ape 2 SOL into BONK
                                </button>
                                <button class="text-left p-3 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-emerald-500 rounded-lg text-sm text-slate-300 hover:text-white font-mono transition-all duration-200 hover-lift" onclick="setExample('Convert 100 USDC to SOL with 0.5% slippage')">
                                    <span class="text-blue-400">üí±</span> Convert 100 USDC to SOL
                                </button>
                                <button class="text-left p-3 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-emerald-500 rounded-lg text-sm text-slate-300 hover:text-white font-mono transition-all duration-200 hover-lift" onclick="setExample('Liquid stake 10 SOL with Marinade')">
                                    <span class="text-purple-400">ü•©</span> Liquid stake with Marinade
                                </button>
                                <button class="text-left p-3 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-emerald-500 rounded-lg text-sm text-slate-300 hover:text-white font-mono transition-all duration-200 hover-lift" onclick="setExample('Write onchain memo: gm from SolForge')">
                                    <span class="text-green-400">üìù</span> Write onchain memo
                                </button>
                                <button class="text-left p-3 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-emerald-500 rounded-lg text-sm text-slate-300 hover:text-white font-mono transition-all duration-200 hover-lift" onclick="setExample('Swap 5 SOL for BONK on Jupiter')">
                                    <span class="text-yellow-400">üîÑ</span> Swap SOL for BONK
                                </button>
                                <button class="text-left p-3 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-emerald-500 rounded-lg text-sm text-slate-300 hover:text-white font-mono transition-all duration-200 hover-lift" onclick="setExample('Buy 1 SOL of pair JDDgQhrQDie1AHAYRqpKW68EiZQpGfmJaNdZrqabAguq')">
                                    <span class="text-pink-400">üíé</span> Buy SOL of pair
                                </button>
                                <button class="text-left p-3 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-emerald-500 rounded-lg text-sm text-slate-300 hover:text-white font-mono transition-all duration-200 hover-lift" onclick="setExample('Swap 0.5 SOL for USDC with 3% slippage and tip 0.01 SOL to Jito')">
                                    <span class="text-orange-400">‚õìÔ∏è</span> Multi: Swap + Jito tip
                                </button>
                            </div>
                        </div>

                        <!-- Wallet Connection -->
                        <div class="space-y-3">
                            <label class="block text-sm font-medium text-slate-200">Wallet Connection</label>
                            <button id="connect-wallet-btn" class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 border border-emerald-500 text-white font-medium rounded-xl transition-all duration-200 hover:scale-105" onclick="connectWallet()">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                </svg>
                                Connect Wallet
                            </button>
                            <div id="wallet-not-found" class="hidden p-4 bg-red-900/50 border border-red-700 rounded-xl text-red-200">
                                <p>Install <a href="https://phantom.app" target="_blank" class="text-emerald-400 hover:text-emerald-300 underline">Phantom</a> or another Solana wallet to sign transactions</p>
                            </div>
                        </div>
                        
                        <!-- Payer Address -->
                        <div class="space-y-3">
                            <label class="block text-sm font-medium text-slate-200">Payer Address</label>
                            <input 
                                type="text" 
                                id="payer-input" 
                                class="w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-xl text-white placeholder-slate-400 font-mono text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all duration-200"
                                placeholder="Your wallet address (optional - uses default if empty)"
                            />
                        </div>

                        <!-- Simulation Toggle -->
                        <div class="flex items-center space-x-3">
                            <div class="flex items-center space-x-3 cursor-pointer select-none" onclick="toggleSimulation()">
                                <div id="toggle-track" class="relative w-12 h-6 bg-slate-600 rounded-full transition-all duration-300">
                                    <div id="toggle-knob" class="absolute top-0.5 left-0.5 w-5 h-5 bg-slate-400 rounded-full transition-all duration-300"></div>
                                </div>
                                <input type="hidden" id="simulate-toggle" value="off">
                                <span class="text-sm text-slate-300" id="simulate-label">
                                    Simulate transaction 
                                    <span class="text-slate-500">(requires funded wallet)</span>
                                </span>
                            </div>
                        </div>
                        
                        <!-- Example Prompts -->
                        <!-- Build Button -->
                        <button id="build-btn" class="w-full py-4 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white font-semibold rounded-xl transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-emerald-500/25 flex items-center justify-center" onclick="buildTransaction()">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            Build Transaction
                        </button>

                        <!-- Sign & Send Button (right below Build) -->
                        <button id="sign-send-btn" class="hidden w-full py-4 bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white font-semibold rounded-xl transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-amber-500/25 flex items-center justify-center mt-3" onclick="signAndSendTransaction()">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                            </svg>
                            Sign & Send Transaction
                        </button>
                        
                        <div id="transaction-result" class="hidden mt-3"></div>
                    </div>
                    
                    <!-- Output Section -->
                    <div class="mt-8 space-y-4">
                        <label class="block text-sm font-medium text-slate-200">Transaction Output</label>
                        
                        <!-- Transaction Preview Card -->
                        <div id="transaction-preview" class="hidden bg-slate-800 border border-slate-700 rounded-xl p-6 animate-fade-in">
                            <!-- Content will be populated by JavaScript -->
                        </div>
                        
                        <div class="relative">
                            <div id="demo-output" class="code-highlight border border-slate-600 rounded-xl p-6 min-h-[200px] font-mono text-sm text-slate-300 whitespace-pre-wrap overflow-x-auto">
                                Click "Build Transaction" to see the API response...
                            </div>
                            <button class="absolute top-4 right-4 p-2 text-slate-400 hover:text-white transition-colors" onclick="copyToClipboard('demo-output')" title="Copy to clipboard">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="py-20 bg-slate-900">
        <div class="container mx-auto px-6">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 text-white">Why SolForge?</h2>
                <p class="text-lg text-slate-300 max-w-2xl mx-auto">
                    Built for the next generation of blockchain applications, SolForge provides unmatched capabilities for Solana development.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-slate-800 border border-slate-700 rounded-xl p-6 hover-lift">
                    <div class="w-12 h-12 bg-gradient-to-r from-emerald-500 to-emerald-600 rounded-lg flex items-center justify-center mb-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2 text-white">12+ Protocols</h3>
                    <p class="text-slate-300 text-sm">
                        Jupiter, Raydium, Orca, Marinade, Pump.fun, and more ‚Äî all in one unified API.
                    </p>
                </div>
                
                <div class="bg-slate-800 border border-slate-700 rounded-xl p-6 hover-lift">
                    <div class="w-12 h-12 bg-gradient-to-r from-cyan-500 to-cyan-600 rounded-lg flex items-center justify-center mb-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2 text-white">Jupiter Routing</h3>
                    <p class="text-slate-300 text-sm">
                        Optimal swap paths with the best prices across all Solana DEXs and liquidity sources.
                    </p>
                </div>
                
                <div class="bg-slate-800 border border-slate-700 rounded-xl p-6 hover-lift">
                    <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg flex items-center justify-center mb-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2 text-white">DexScreener Resolution</h3>
                    <p class="text-slate-300 text-sm">
                        Auto-detect protocols from token addresses and trading pairs with real-time data.
                    </p>
                </div>
                
                <div class="bg-slate-800 border border-slate-700 rounded-xl p-6 hover-lift">
                    <div class="w-12 h-12 bg-gradient-to-r from-pink-500 to-pink-600 rounded-lg flex items-center justify-center mb-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2 text-white">Natural Language</h3>
                    <p class="text-slate-300 text-sm">
                        Transform plain English commands into executable Solana transactions effortlessly.
                    </p>
                </div>

                <div class="bg-slate-800 border border-slate-700 rounded-xl p-6 hover-lift">
                    <div class="w-12 h-12 bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg flex items-center justify-center mb-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2 text-white">MCP Server</h3>
                    <p class="text-slate-300 text-sm">
                        Plug into any AI agent (Claude, GPT) via Model Context Protocol. Direct tool integration, no HTTP overhead.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- MCP Integration Section -->
    <section class="py-20 bg-slate-800 border-t border-slate-700">
        <div class="container mx-auto px-6">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 text-white">üîå MCP Server</h2>
                <p class="text-lg text-slate-300 max-w-2xl mx-auto">
                    Plug SolForge into any AI agent via the <a href="https://modelcontextprotocol.io" target="_blank" class="text-emerald-400 hover:text-emerald-300 underline">Model Context Protocol</a>. No REST calls needed ‚Äî direct tool integration.
                </p>
            </div>
            
            <div class="max-w-4xl mx-auto space-y-8">
                <!-- Setup -->
                <div class="bg-slate-900 border border-slate-700 rounded-xl p-6">
                    <h3 class="text-xl font-semibold text-white mb-4">Quick Setup</h3>
                    <p class="text-slate-300 text-sm mb-4">Add to your <code class="text-emerald-400 bg-slate-800 px-1.5 py-0.5 rounded">claude_desktop_config.json</code>:</p>
                    <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">{
  "mcpServers": {
    "solforge": {
      "command": "node",
      "args": ["/path/to/solforge/dist/mcp.js"],
      "env": {
        "SOLANA_MAINNET_RPC": "your_rpc_url",
        "JUPITER_API_URL": "https://lite-api.jup.ag/swap/v1"
      }
    }
  }
}</pre>
                </div>

                <!-- Tools Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div class="bg-slate-900 border border-slate-700 rounded-xl p-5">
                        <div class="flex items-center mb-2">
                            <span class="px-2 py-0.5 bg-emerald-500/20 text-emerald-300 text-xs font-bold font-mono rounded mr-2">‚≠ê</span>
                            <span class="font-mono text-sm text-white">build_transaction_natural</span>
                        </div>
                        <p class="text-slate-400 text-sm">Natural language ‚Üí ready-to-sign transaction. The main tool.</p>
                    </div>
                    <div class="bg-slate-900 border border-slate-700 rounded-xl p-5">
                        <span class="font-mono text-sm text-white block mb-2">build_transaction</span>
                        <p class="text-slate-400 text-sm">Structured intent builder for programmatic use.</p>
                    </div>
                    <div class="bg-slate-900 border border-slate-700 rounded-xl p-5">
                        <span class="font-mono text-sm text-white block mb-2">resolve_token</span>
                        <p class="text-slate-400 text-sm">Look up any token or pair via DexScreener.</p>
                    </div>
                    <div class="bg-slate-900 border border-slate-700 rounded-xl p-5">
                        <span class="font-mono text-sm text-white block mb-2">list_protocols</span>
                        <p class="text-slate-400 text-sm">See all 12+ supported Solana protocols.</p>
                    </div>
                    <div class="bg-slate-900 border border-slate-700 rounded-xl p-5">
                        <span class="font-mono text-sm text-white block mb-2">estimate_transaction</span>
                        <p class="text-slate-400 text-sm">Check fees and compute units before building.</p>
                    </div>
                    <div class="bg-slate-900 border border-slate-700 rounded-xl p-5">
                        <span class="font-mono text-sm text-white block mb-2">decode_transaction</span>
                        <p class="text-slate-400 text-sm">Decode any base64 Solana transaction.</p>
                    </div>
                </div>

                <!-- Skill file callout -->
                <div class="bg-gradient-to-r from-emerald-900/30 to-cyan-900/30 border border-emerald-700/50 rounded-xl p-6 text-center">
                    <p class="text-slate-200 mb-2">Want your AI agent to use SolForge without MCP setup?</p>
                    <p class="text-slate-300 text-sm">Copy <a href="https://github.com/rikisann/solforge/blob/main/SKILL.md" target="_blank" class="text-emerald-400 hover:text-emerald-300 underline font-mono">SKILL.md</a> into your agent's context ‚Äî it instantly learns all endpoints and best practices.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- API Reference Section -->
    <section id="api" class="py-20 bg-slate-900">
        <div class="container mx-auto px-6">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 text-white">API Reference</h2>
                <p class="text-lg text-slate-300 max-w-2xl mx-auto">
                    Comprehensive API documentation with interactive examples. Click any endpoint to view details, parameters, and code samples.
                </p>
            </div>
            
            <div class="max-w-6xl mx-auto space-y-4">
                <!-- POST /api/build/natural -->
                <details class="group bg-slate-900 border border-slate-700 rounded-xl overflow-hidden">
                    <summary class="flex items-center justify-between p-5 cursor-pointer hover:bg-slate-800/50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="px-3 py-1 bg-amber-500/20 text-amber-300 text-xs font-bold font-mono rounded">POST</span>
                            <span class="font-mono text-slate-200">/api/build/natural</span>
                            <span class="text-slate-400 text-sm">Transform natural language into transactions</span>
                        </div>
                        <svg class="w-5 h-5 text-slate-400 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <div class="px-5 pb-5 border-t border-slate-700/50 pt-4 space-y-4">
                        <p class="text-slate-300">
                            The star endpoint of SolForge. Converts natural language prompts into executable Solana transactions with intelligent protocol detection and automatic token resolution.
                        </p>
                        
                        <!-- Parameters Table -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Parameters</h4>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead>
                                        <tr class="border-b border-slate-700">
                                            <th class="text-left py-2 text-slate-300 font-medium">Name</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Type</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Required</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">prompt</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Natural language description of the transaction</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">payer</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Wallet address that will pay for and sign the transaction</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">network</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-slate-500">No</td>
                                            <td class="py-2 text-slate-300">Network to use (default: "mainnet")</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">skipSimulation</td>
                                            <td class="py-2 text-slate-400">boolean</td>
                                            <td class="py-2 text-slate-500">No</td>
                                            <td class="py-2 text-slate-300">Skip transaction simulation (faster response)</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">priorityFee</td>
                                            <td class="py-2 text-slate-400">number</td>
                                            <td class="py-2 text-slate-500">No</td>
                                            <td class="py-2 text-slate-300">Priority fee in lamports</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">computeBudget</td>
                                            <td class="py-2 text-slate-400">number</td>
                                            <td class="py-2 text-slate-500">No</td>
                                            <td class="py-2 text-slate-300">Compute budget limit</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Example Request -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Request</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">curl -X POST https://api.solforge.dev/api/build/natural \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "Swap 1 SOL for USDC",
    "payer": "YOUR_WALLET_ADDRESS"
  }'</pre>
                            </div>
                        </div>

                        <!-- Example Response -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Response</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">{
  "success": true,
  "transaction": "base64_encoded_transaction_data...",
  "details": {
    "protocol": "jupiter",
    "parsedIntent": {
      "action": "swap",
      "protocol": "jupiter",
      "params": {
        "from": "So11111111111111111111111111111111111111112",
        "to": "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",
        "amount": 1.0
      }
    },
    "confidence": 0.95
  }
}</pre>
                            </div>
                        </div>
                    </div>
                </details>


                <!-- POST /api/build -->
                <details class="group bg-slate-900 border border-slate-700 rounded-xl overflow-hidden">
                    <summary class="flex items-center justify-between p-5 cursor-pointer hover:bg-slate-800/50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="px-3 py-1 bg-amber-500/20 text-amber-300 text-xs font-bold font-mono rounded">POST</span>
                            <span class="font-mono text-slate-200">/api/build</span>
                            <span class="text-slate-400 text-sm">Structured intent builder for programmatic use</span>
                        </div>
                        <svg class="w-5 h-5 text-slate-400 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <div class="px-5 pb-5 border-t border-slate-700/50 pt-4 space-y-4">
                        <p class="text-slate-300">
                            Build transactions from structured intent objects when you know the exact protocol and parameters. Perfect for programmatic integrations and when you need precise control.
                        </p>
                        
                        <!-- Parameters Table -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Parameters</h4>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead>
                                        <tr class="border-b border-slate-700">
                                            <th class="text-left py-2 text-slate-300 font-medium">Name</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Type</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Required</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">intent</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Intent name (e.g. "swap", "memo", "transfer", "marinade-stake")</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">params</td>
                                            <td class="py-2 text-slate-400">object</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Intent-specific parameters</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">payer</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Wallet address that will pay for the transaction</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">network</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-slate-500">No</td>
                                            <td class="py-2 text-slate-300">Network to use (default: "mainnet")</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">skipSimulation</td>
                                            <td class="py-2 text-slate-400">boolean</td>
                                            <td class="py-2 text-slate-500">No</td>
                                            <td class="py-2 text-slate-300">Skip transaction simulation</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Example Request -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Request</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">curl -X POST https://api.solforge.dev/api/build \
  -H "Content-Type: application/json" \
  -d '{
    "intent": "memo",
    "params": {
      "message": "gm"
    },
    "payer": "YOUR_WALLET_ADDRESS"
  }'</pre>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- POST /api/build/multi -->
                <details class="group bg-slate-900 border border-slate-700 rounded-xl overflow-hidden">
                    <summary class="flex items-center justify-between p-5 cursor-pointer hover:bg-slate-800/50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="px-3 py-1 bg-amber-500/20 text-amber-300 text-xs font-bold font-mono rounded">POST</span>
                            <span class="font-mono text-slate-200">/api/build/multi</span>
                            <span class="text-slate-400 text-sm">Batch multiple intents into one atomic transaction</span>
                        </div>
                        <svg class="w-5 h-5 text-slate-400 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <div class="px-5 pb-5 border-t border-slate-700/50 pt-4 space-y-4">
                        <p class="text-slate-300">
                            Combine multiple operations into one atomic transaction. Perfect for complex workflows like "swap and stake" or batch operations that must succeed or fail together.
                        </p>
                        
                        <!-- Parameters Table -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Parameters</h4>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead>
                                        <tr class="border-b border-slate-700">
                                            <th class="text-left py-2 text-slate-300 font-medium">Name</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Type</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Required</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">intents</td>
                                            <td class="py-2 text-slate-400">BuildIntent[]</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Array of BuildIntent objects</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">payer</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Wallet address that will pay for the transaction</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">network</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-slate-500">No</td>
                                            <td class="py-2 text-slate-300">Network to use (default: "mainnet")</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Example Request -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Request</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">curl -X POST https://api.solforge.dev/api/build/multi \
  -H "Content-Type: application/json" \
  -d '{
    "intents": [
      {
        "intent": "memo",
        "params": {"message": "batch tx"}
      },
      {
        "intent": "transfer",
        "params": {"to": "ADDRESS...", "amount": 0.01}
      }
    ],
    "payer": "YOUR_WALLET_ADDRESS"
  }'</pre>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- POST /api/decode -->
                <details class="group bg-slate-900 border border-slate-700 rounded-xl overflow-hidden">
                    <summary class="flex items-center justify-between p-5 cursor-pointer hover:bg-slate-800/50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="px-3 py-1 bg-amber-500/20 text-amber-300 text-xs font-bold font-mono rounded">POST</span>
                            <span class="font-mono text-slate-200">/api/decode</span>
                            <span class="text-slate-400 text-sm">Decode base64 transaction into human-readable format</span>
                        </div>
                        <svg class="w-5 h-5 text-slate-400 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <div class="px-5 pb-5 border-t border-slate-700/50 pt-4 space-y-4">
                        <p class="text-slate-300">
                            Decode any Solana transaction from its base64 encoded format into a human-readable structure. Useful for analyzing transactions before signing or understanding their effects.
                        </p>
                        
                        <!-- Parameters Table -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Parameters</h4>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead>
                                        <tr class="border-b border-slate-700">
                                            <th class="text-left py-2 text-slate-300 font-medium">Name</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Type</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Required</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">transaction</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Base64 encoded transaction data</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Example Request -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Request</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">curl -X POST https://api.solforge.dev/api/decode \
  -H "Content-Type: application/json" \
  -d '{
    "transaction": "AQAAAA..."
  }'</pre>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- POST /api/estimate -->
                <details class="group bg-slate-900 border border-slate-700 rounded-xl overflow-hidden">
                    <summary class="flex items-center justify-between p-5 cursor-pointer hover:bg-slate-800/50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="px-3 py-1 bg-amber-500/20 text-amber-300 text-xs font-bold font-mono rounded">POST</span>
                            <span class="font-mono text-slate-200">/api/estimate</span>
                            <span class="text-slate-400 text-sm">Estimate fees and costs before building</span>
                        </div>
                        <svg class="w-5 h-5 text-slate-400 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <div class="px-5 pb-5 border-t border-slate-700/50 pt-4 space-y-4">
                        <p class="text-slate-300">
                            Estimate transaction costs including fees, rent, and compute units before actually building the transaction. Helps users understand costs upfront.
                        </p>
                        
                        <!-- Parameters Table -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Parameters</h4>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead>
                                        <tr class="border-b border-slate-700">
                                            <th class="text-left py-2 text-slate-300 font-medium">Name</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Type</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Required</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">intent</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Intent name to estimate</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">params</td>
                                            <td class="py-2 text-slate-400">object</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Intent parameters</td>
                                        </tr>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">payer</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Payer wallet address</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Example Request -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Request</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">curl -X POST https://api.solforge.dev/api/estimate \
  -H "Content-Type: application/json" \
  -d '{
    "intent": "swap",
    "params": {"from": "SOL", "to": "USDC", "amount": 1},
    "payer": "YOUR_WALLET_ADDRESS"
  }'</pre>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- GET /api/resolve -->
                <details class="group bg-slate-900 border border-slate-700 rounded-xl overflow-hidden">
                    <summary class="flex items-center justify-between p-5 cursor-pointer hover:bg-slate-800/50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="px-3 py-1 bg-emerald-500/20 text-emerald-300 text-xs font-bold font-mono rounded">GET</span>
                            <span class="font-mono text-slate-200">/api/resolve</span>
                            <span class="text-slate-400 text-sm">Look up token/pair info via DexScreener</span>
                        </div>
                        <svg class="w-5 h-5 text-slate-400 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <div class="px-5 pb-5 border-t border-slate-700/50 pt-4 space-y-4">
                        <p class="text-slate-300">
                            Look up token or trading pair information using DexScreener integration. Returns token metadata, pricing, liquidity, and primary DEX information.
                        </p>
                        
                        <!-- Parameters Table -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Query Parameters</h4>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead>
                                        <tr class="border-b border-slate-700">
                                            <th class="text-left py-2 text-slate-300 font-medium">Name</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Type</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Required</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">query</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Token address, pair address, or symbol</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Example Request -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Request</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">curl "https://api.solforge.dev/api/resolve?query=BONK"

# Or with token address:
curl "https://api.solforge.dev/api/resolve?query=DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263"</pre>
                            </div>
                        </div>

                        <!-- Example Response -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Response</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">{
  "success": true,
  "type": "token",
  "result": {
    "symbol": "BONK",
    "name": "Bonk",
    "address": "DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263",
    "primaryDex": "jupiter",
    "liquidity": 12500000,
    "price": 0.000023
  }
}</pre>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- GET /api/protocols -->
                <details class="group bg-slate-900 border border-slate-700 rounded-xl overflow-hidden">
                    <summary class="flex items-center justify-between p-5 cursor-pointer hover:bg-slate-800/50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="px-3 py-1 bg-emerald-500/20 text-emerald-300 text-xs font-bold font-mono rounded">GET</span>
                            <span class="font-mono text-slate-200">/api/protocols</span>
                            <span class="text-slate-400 text-sm">List all supported protocols</span>
                        </div>
                        <svg class="w-5 h-5 text-slate-400 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <div class="px-5 pb-5 border-t border-slate-700/50 pt-4 space-y-4">
                        <p class="text-slate-300">
                            Get a complete list of all supported protocols with their capabilities, supported intents, and status information.
                        </p>
                        
                        <!-- Parameters Table -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Parameters</h4>
                            <p class="text-slate-400 text-sm">No parameters required.</p>
                        </div>

                        <!-- Example Request -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Request</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">curl "https://api.solforge.dev/api/protocols"</pre>
                            </div>
                        </div>

                        <!-- Example Response -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Response</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">{
  "success": true,
  "protocols": [
    {
      "name": "jupiter",
      "description": "Jupiter DEX aggregator for optimal swaps",
      "supportedIntents": ["swap"],
      "status": "active"
    },
    {
      "name": "marinade",
      "description": "Liquid staking protocol",
      "supportedIntents": ["marinade-stake", "marinade-unstake"],
      "status": "active"
    }
  ],
  "count": 12
}</pre>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- GET /api/protocols/:name/schema -->
                <details class="group bg-slate-900 border border-slate-700 rounded-xl overflow-hidden">
                    <summary class="flex items-center justify-between p-5 cursor-pointer hover:bg-slate-800/50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="px-3 py-1 bg-emerald-500/20 text-emerald-300 text-xs font-bold font-mono rounded">GET</span>
                            <span class="font-mono text-slate-200">/api/protocols/:name/schema</span>
                            <span class="text-slate-400 text-sm">Get parameter schema for a protocol</span>
                        </div>
                        <svg class="w-5 h-5 text-slate-400 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <div class="px-5 pb-5 border-t border-slate-700/50 pt-4 space-y-4">
                        <p class="text-slate-300">
                            Get the complete parameter schema for a specific protocol, including required/optional fields, types, and examples for each supported intent.
                        </p>
                        
                        <!-- Parameters Table -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Path Parameters</h4>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead>
                                        <tr class="border-b border-slate-700">
                                            <th class="text-left py-2 text-slate-300 font-medium">Name</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Type</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Required</th>
                                            <th class="text-left py-2 text-slate-300 font-medium">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-slate-700/50">
                                            <td class="py-2 text-emerald-400 font-mono">name</td>
                                            <td class="py-2 text-slate-400">string</td>
                                            <td class="py-2 text-amber-400">Yes</td>
                                            <td class="py-2 text-slate-300">Protocol name (e.g. "jupiter", "marinade")</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Example Request -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Request</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">curl "https://api.solforge.dev/api/protocols/jupiter/schema"</pre>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- GET /api/docs -->
                <details class="group bg-slate-900 border border-slate-700 rounded-xl overflow-hidden">
                    <summary class="flex items-center justify-between p-5 cursor-pointer hover:bg-slate-800/50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="px-3 py-1 bg-emerald-500/20 text-emerald-300 text-xs font-bold font-mono rounded">GET</span>
                            <span class="font-mono text-slate-200">/api/docs</span>
                            <span class="text-slate-400 text-sm">Full API documentation in JSON format</span>
                        </div>
                        <svg class="w-5 h-5 text-slate-400 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <div class="px-5 pb-5 border-t border-slate-700/50 pt-4 space-y-4">
                        <p class="text-slate-300">
                            Get comprehensive API documentation in machine-readable JSON format. Includes all protocols, schemas, examples, and integration guides.
                        </p>
                        
                        <!-- Parameters Table -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Parameters</h4>
                            <p class="text-slate-400 text-sm">No parameters required.</p>
                        </div>

                        <!-- Example Request -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Request</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">curl "https://api.solforge.dev/api/docs"</pre>
                            </div>
                        </div>

                        <!-- Example Response -->
                        <div class="space-y-2">
                            <h4 class="text-slate-200 font-semibold">Example Response</h4>
                            <div class="relative">
                                <pre class="bg-slate-950 rounded-lg p-4 text-sm font-mono text-slate-300 overflow-x-auto">{
  "success": true,
  "version": "1.0.0",
  "title": "SolForge API Documentation",
  "description": "Universal Solana transaction builder API",
  "protocols": {
    "jupiter": {
      "name": "jupiter",
      "description": "DEX aggregator for optimal swaps",
      "schema": {...},
      "examples": {...}
    }
  },
  "usage": {
    "structured": "/api/build",
    "natural": "/api/build/natural",
    "protocolInfo": "/api/protocols/:name"
  }
}</pre>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-12 bg-slate-900 border-t border-slate-700">
        <div class="container mx-auto px-6">
            <div class="text-center space-y-4">
                <div class="flex items-center justify-center space-x-2 text-lg">
                    <span class="text-slate-300">Built by</span>
                    <span class="gradient-text font-semibold">AI agents</span>
                    <span class="text-slate-300">for the</span>
                    <span class="text-white font-semibold">Colosseum Hackathon</span>
                </div>
                <div class="flex items-center justify-center space-x-6">
                    <a href="https://github.com/rikisann/solforge" target="_blank" class="inline-flex items-center text-emerald-400 hover:text-emerald-300 transition-colors group">
                        <svg class="w-5 h-5 mr-2 group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                        </svg>
                        View on GitHub
                    </a>
                </div>
                <p class="text-sm text-slate-500">
                    ¬© 2026 SolForge. Empowering the future of blockchain interaction.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // Global state
        let simulationEnabled = false;
        let connectedWallet = null;
        let walletProvider = null;
        let lastTransactionData = null;
        let connection = null;

        function getConnection() {
            if (!connection && typeof solanaWeb3 !== 'undefined') {
                const rpcUrl = window.location.origin + '/api/rpc';
                connection = new solanaWeb3.Connection(rpcUrl);
            }
            return connection;
        }

        // Wallet connection
        async function connectWallet() {
            const connectBtn = document.getElementById('connect-wallet-btn');
            const walletNotFound = document.getElementById('wallet-not-found');
            const payerInput = document.getElementById('payer-input');

            try {
                // Hide wallet not found message
                walletNotFound.classList.add('hidden');

                // Check for Phantom or other Solana wallet providers
                const provider = window.phantom?.solana || window.solana;
                
                if (!provider) {
                    walletNotFound.classList.remove('hidden');
                    return;
                }

                connectBtn.textContent = 'Connecting...';
                connectBtn.disabled = true;

                // Connect to wallet
                const response = await provider.connect();
                const publicKey = response.publicKey.toString();

                // Update state
                connectedWallet = publicKey;
                walletProvider = provider;

                // Update UI
                connectBtn.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-2 h-2 bg-emerald-400 rounded-full mr-2"></div>
                        <span class="font-mono">Connected: ${publicKey.slice(0, 4)}...${publicKey.slice(-4)}</span>
                    </div>
                `;
                connectBtn.classList.add('bg-emerald-500/20', 'border-emerald-500');
                connectBtn.disabled = false;

                // Auto-fill payer address
                payerInput.value = publicKey;
                payerInput.classList.add('ring-2', 'ring-emerald-500', 'border-emerald-500');

                console.log('Wallet connected:', publicKey);

            } catch (error) {
                console.error('Wallet connection failed:', error);
                connectBtn.textContent = 'Connect Wallet';
                connectBtn.disabled = false;
                
                if (error.code === 4001) {
                    // User rejected connection
                    alert('Wallet connection rejected by user');
                } else {
                    alert('Failed to connect wallet: ' + error.message);
                }
            }
        }

        // Sign and send transaction
        async function signAndSendTransaction() {
            const signBtn = document.getElementById('sign-send-btn');
            const resultDiv = document.getElementById('transaction-result');

            if (!connectedWallet || !walletProvider) {
                alert('Please connect your wallet first');
                return;
            }

            if (!lastTransactionData || !lastTransactionData.transaction) {
                alert('No transaction to sign. Please build a transaction first.');
                return;
            }

            try {
                signBtn.textContent = 'Signing...';
                signBtn.disabled = true;
                resultDiv.classList.add('hidden');

                const transactionBase64 = lastTransactionData.transaction;
                
                // Try to deserialize as VersionedTransaction first, fallback to legacy Transaction
                let transaction;
                let isVersioned = false;
                
                try {
                    const binaryString = atob(transactionBase64); 
                    const transactionBuffer = new Uint8Array(binaryString.length); 
                    for (let i = 0; i < binaryString.length; i++) { 
                        transactionBuffer[i] = binaryString.charCodeAt(i); 
                    }
                    transaction = solanaWeb3.VersionedTransaction.deserialize(transactionBuffer);
                    isVersioned = true;
                    console.log('Deserialized as VersionedTransaction');
                } catch (versionedError) {
                    console.log('Failed to deserialize as VersionedTransaction, trying legacy:', versionedError.message);
                    try {
                        const binaryString = atob(transactionBase64); 
                        const transactionBuffer = new Uint8Array(binaryString.length); 
                        for (let i = 0; i < binaryString.length; i++) { 
                            transactionBuffer[i] = binaryString.charCodeAt(i); 
                        }
                        transaction = solanaWeb3.Transaction.from(transactionBuffer);
                        isVersioned = false;
                        console.log('Deserialized as legacy Transaction');
                    } catch (legacyError) {
                        throw new Error(`Failed to deserialize transaction: ${legacyError.message}`);
                    }
                }

                // Refresh blockhash before signing (server-built tx may have stale blockhash)
                signBtn.textContent = 'Refreshing blockhash...';
                const conn = getConnection();
                const { blockhash, lastValidBlockHeight } = await conn.getLatestBlockhash('confirmed');
                if (isVersioned) {
                    transaction.message.recentBlockhash = blockhash;
                } else {
                    transaction.recentBlockhash = blockhash;
                }

                // Sign transaction
                signBtn.textContent = 'Waiting for signature...';
                const signedTransaction = await walletProvider.signTransaction(transaction);

                // Send transaction
                signBtn.textContent = 'Sending transaction...';
                const rawTransaction = signedTransaction.serialize();
                const signature = await getConnection().sendRawTransaction(rawTransaction, {
                    skipPreflight: false,
                    preflightCommitment: 'processed'
                });

                // Show success immediately ‚Äî tx is submitted, user can track on Solscan
                resultDiv.innerHTML = `
                    <div class="p-4 bg-emerald-900/50 border border-emerald-700 rounded-xl text-emerald-200">
                        <div class="flex items-center mb-2">
                            <svg class="w-5 h-5 text-emerald-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <strong>Transaction sent successfully! üéâ</strong>
                        </div>
                        <div class="space-y-2 text-sm">
                            <div>
                                <strong>Signature:</strong> 
                                <span class="font-mono text-xs break-all">${signature}</span>
                            </div>
                            <div>
                                <strong>Explorer:</strong> 
                                <a href="https://solscan.io/tx/${signature}" target="_blank" class="text-emerald-400 hover:text-emerald-300 underline">View on Solscan ‚Üí</a>
                            </div>
                        </div>
                    </div>
                `;
                resultDiv.classList.remove('hidden');

                console.log('Transaction sent:', signature);

            } catch (error) {
                console.error('Transaction failed:', error);
                
                let errorMessage = error.message;
                let suggestions = [];
                
                if (error.code === 4001) {
                    errorMessage = 'Transaction rejected by user';
                } else if (error.message.includes('insufficient') || error.message.includes('lamports')) {
                    // Parse the actual amounts if available
                    const match = error.message.match(/insufficient lamports (\d+), need (\d+)/);
                    if (match) {
                        const have = (parseInt(match[1]) / 1e9).toFixed(4);
                        const need = (parseInt(match[2]) / 1e9).toFixed(4);
                        errorMessage = `Insufficient SOL: you have ${have} SOL but need ${need} SOL`;
                    } else {
                        errorMessage = 'Insufficient funds in wallet';
                    }
                    suggestions = ['Try a smaller amount', 'Add more SOL to your wallet', 'Account for fees (~0.01 SOL) when calculating amounts'];
                } else if (error.message.includes('blockhash')) {
                    errorMessage = 'Transaction expired ‚Äî blockhash too old';
                    suggestions = ['Click Build Transaction again to get a fresh transaction', 'Sign faster after building'];
                } else if (error.message.includes('0x1')) {
                    // Generic program error, check for common causes
                    if (error.message.includes('Transfer:')) {
                        errorMessage = 'Transfer failed ‚Äî likely insufficient funds';
                        suggestions = ['Try a smaller amount', 'Make sure you have enough SOL for the transaction + fees'];
                    }
                } else if (error.message.includes('simulation failed') || error.message.includes('Simulation failed')) {
                    suggestions = ['Try with a smaller amount', 'Make sure your wallet is funded', 'Try rebuilding the transaction'];
                }

                const suggestionsHtml = suggestions.length > 0 
                    ? `<div class="mt-3 pt-3 border-t border-red-700/50">
                        <p class="text-xs font-semibold text-red-300 mb-1">üí° Suggestions:</p>
                        <ul class="text-xs text-red-300/80 list-disc list-inside space-y-0.5">
                            ${suggestions.map(s => `<li>${s}</li>`).join('')}
                        </ul>
                       </div>` 
                    : '';

                resultDiv.innerHTML = `
                    <div class="p-4 bg-red-900/50 border border-red-700 rounded-xl text-red-200">
                        <div class="flex items-center mb-2">
                            <svg class="w-5 h-5 text-red-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <strong>Transaction failed</strong>
                        </div>
                        <p class="text-sm">${errorMessage}</p>
                        ${suggestionsHtml}
                    </div>
                `;
                resultDiv.classList.remove('hidden');

            } finally {
                signBtn.textContent = 'Sign & Send Transaction';
                signBtn.disabled = false;
            }
        }

        // Sign and send all transactions in sequence
        async function signAndSendAllTransactions() {
            if (!connectedWallet || !walletProvider) {
                alert('Please connect your wallet first');
                return;
            }

            if (!lastTransactionData || !lastTransactionData.transactions) {
                alert('No transactions to sign. Please build a transaction first.');
                return;
            }

            const signAllBtn = document.getElementById('sign-send-all-btn');
            const resultDiv = document.getElementById('transaction-result');
            const transactions = lastTransactionData.transactions;

            try {
                signAllBtn.textContent = 'Signing and sending transactions...';
                signAllBtn.disabled = true;
                resultDiv.classList.add('hidden');

                const results = [];
                
                for (let i = 0; i < transactions.length; i++) {
                    const tx = transactions[i];
                    signAllBtn.textContent = `Processing transaction ${i + 1} of ${transactions.length}...`;
                    
                    try {
                        const signature = await signAndSendSingleTransaction(tx.transaction);
                        results.push({
                            index: i,
                            success: true,
                            signature: signature,
                            details: tx.details
                        });
                    } catch (error) {
                        results.push({
                            index: i,
                            success: false,
                            error: error.message,
                            details: tx.details
                        });
                        // Continue with other transactions even if one fails
                    }
                }

                // Show results
                showMultiTransactionResults(results);

            } catch (error) {
                console.error('Multi-transaction signing failed:', error);
                resultDiv.innerHTML = `
                    <div class="p-4 bg-red-900/50 border border-red-700 rounded-xl text-red-200">
                        <div class="flex items-center mb-2">
                            <svg class="w-5 h-5 text-red-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <strong>Multi-transaction failed</strong>
                        </div>
                        <p class="text-sm">${error.message}</p>
                    </div>
                `;
                resultDiv.classList.remove('hidden');
            } finally {
                signAllBtn.textContent = 'Sign & Send All';
                signAllBtn.disabled = false;
            }
        }

        // Sign and send a single transaction (overloaded to handle individual transactions)
        async function signAndSendTransaction(transactionIndex = null) {
            if (transactionIndex !== null && lastTransactionData && lastTransactionData.transactions) {
                // Handle individual transaction from multi-transaction response
                const tx = lastTransactionData.transactions[transactionIndex];
                if (!tx) {
                    alert('Transaction not found');
                    return;
                }

                try {
                    const signature = await signAndSendSingleTransaction(tx.transaction);
                    showSingleTransactionResult(signature, tx.details, transactionIndex);
                } catch (error) {
                    showSingleTransactionError(error.message, transactionIndex);
                }
                return;
            }

            // Original single transaction flow
            const signBtn = document.getElementById('sign-send-btn');
            const resultDiv = document.getElementById('transaction-result');

            if (!connectedWallet || !walletProvider) {
                alert('Please connect your wallet first');
                return;
            }

            if (!lastTransactionData || !lastTransactionData.transaction) {
                alert('No transaction to sign. Please build a transaction first.');
                return;
            }

            try {
                signBtn.textContent = 'Signing...';
                signBtn.disabled = true;
                resultDiv.classList.add('hidden');

                const signature = await signAndSendSingleTransaction(lastTransactionData.transaction);
                showSingleTransactionResult(signature, lastTransactionData.details || {});

            } catch (error) {
                console.error('Transaction failed:', error);
                showSingleTransactionError(error.message);
            } finally {
                signBtn.textContent = 'Sign & Send Transaction';
                signBtn.disabled = false;
            }
        }

        // Helper function to sign and send a single transaction
        async function signAndSendSingleTransaction(transactionBase64) {
            // Try to deserialize as VersionedTransaction first, fallback to legacy Transaction
            let transaction;
            let isVersioned = false;
            
            try {
                const binaryString = atob(transactionBase64); 
                const transactionBuffer = new Uint8Array(binaryString.length); 
                for (let i = 0; i < binaryString.length; i++) { 
                    transactionBuffer[i] = binaryString.charCodeAt(i); 
                }
                transaction = solanaWeb3.VersionedTransaction.deserialize(transactionBuffer);
                isVersioned = true;
                console.log('Deserialized as VersionedTransaction');
            } catch (versionedError) {
                console.log('Failed to deserialize as VersionedTransaction, trying legacy:', versionedError.message);
                try {
                    const binaryString = atob(transactionBase64); 
                    const transactionBuffer = new Uint8Array(binaryString.length); 
                    for (let i = 0; i < binaryString.length; i++) { 
                        transactionBuffer[i] = binaryString.charCodeAt(i); 
                    }
                    transaction = solanaWeb3.Transaction.from(transactionBuffer);
                    isVersioned = false;
                    console.log('Deserialized as legacy Transaction');
                } catch (legacyError) {
                    throw new Error(`Failed to deserialize transaction: ${legacyError.message}`);
                }
            }

            // Refresh blockhash before signing (server-built tx may have stale blockhash)
            const conn = getConnection();
            const { blockhash, lastValidBlockHeight } = await conn.getLatestBlockhash('confirmed');
            if (isVersioned) {
                transaction.message.recentBlockhash = blockhash;
            } else {
                transaction.recentBlockhash = blockhash;
            }

            // Sign transaction
            const signedTransaction = await walletProvider.signTransaction(transaction);

            // Send transaction
            const rawTransaction = signedTransaction.serialize();
            const signature = await getConnection().sendRawTransaction(rawTransaction, {
                skipPreflight: false,
                preflightCommitment: 'processed'
            });

            return signature;
        }

        // Show multi-transaction results
        function showMultiTransactionResults(results) {
            const resultDiv = document.getElementById('transaction-result');
            const successCount = results.filter(r => r.success).length;
            const totalCount = results.length;

            let html = `
                <div class="p-4 ${successCount === totalCount ? 'bg-emerald-900/50 border-emerald-700' : 'bg-yellow-900/50 border-yellow-700'} border rounded-xl">
                    <div class="flex items-center mb-3">
                        <svg class="w-5 h-5 ${successCount === totalCount ? 'text-emerald-400' : 'text-yellow-400'} mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <strong>Multi-transaction complete: ${successCount}/${totalCount} succeeded</strong>
                    </div>
                    <div class="space-y-2">
            `;

            results.forEach((result, index) => {
                const action = result.details.action || result.details.parsedIntent?.action || 'operation';
                if (result.success) {
                    html += `
                        <div class="p-2 bg-emerald-800/30 rounded-lg text-emerald-200 text-sm">
                            <div class="font-medium">${index + 1}. ${capitalizeProtocol(action)} - ‚úÖ Success</div>
                            <div class="font-mono text-xs break-all mt-1">${result.signature}</div>
                            <div class="mt-1">
                                <a href="https://solscan.io/tx/${result.signature}" target="_blank" class="text-emerald-400 hover:text-emerald-300 underline">View on Solscan ‚Üí</a>
                            </div>
                        </div>
                    `;
                } else {
                    html += `
                        <div class="p-2 bg-red-800/30 rounded-lg text-red-200 text-sm">
                            <div class="font-medium">${index + 1}. ${capitalizeProtocol(action)} - ‚ùå Failed</div>
                            <div class="text-xs mt-1">${result.error}</div>
                        </div>
                    `;
                }
            });

            html += `
                    </div>
                </div>
            `;

            resultDiv.innerHTML = html;
            resultDiv.classList.remove('hidden');
        }

        // Show single transaction result
        function showSingleTransactionResult(signature, details, transactionIndex = null) {
            const resultDiv = document.getElementById('transaction-result');
            const action = details.action || details.parsedIntent?.action || 'operation';
            const indexText = transactionIndex !== null ? ` (${transactionIndex + 1})` : '';

            resultDiv.innerHTML = `
                <div class="p-4 bg-emerald-900/50 border border-emerald-700 rounded-xl text-emerald-200">
                    <div class="flex items-center mb-2">
                        <svg class="w-5 h-5 text-emerald-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <strong>${capitalizeProtocol(action)} transaction${indexText} sent successfully! üéâ</strong>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div>
                            <strong>Signature:</strong> 
                            <span class="font-mono text-xs break-all">${signature}</span>
                        </div>
                        <div>
                            <strong>Explorer:</strong> 
                            <a href="https://solscan.io/tx/${signature}" target="_blank" class="text-emerald-400 hover:text-emerald-300 underline">View on Solscan ‚Üí</a>
                        </div>
                    </div>
                </div>
            `;
            resultDiv.classList.remove('hidden');
        }

        // Show single transaction error
        function showSingleTransactionError(errorMessage, transactionIndex = null) {
            const resultDiv = document.getElementById('transaction-result');
            const indexText = transactionIndex !== null ? ` (${transactionIndex + 1})` : '';

            let displayError = errorMessage;
            if (errorMessage.includes('4001')) {
                displayError = 'Transaction rejected by user';
            } else if (errorMessage.includes('insufficient funds')) {
                displayError = 'Insufficient funds in wallet';
            } else if (errorMessage.includes('blockhash not found')) {
                displayError = 'Transaction expired, please rebuild and try again';
            }

            resultDiv.innerHTML = `
                <div class="p-4 bg-red-900/50 border border-red-700 rounded-xl text-red-200">
                    <div class="flex items-center mb-2">
                        <svg class="w-5 h-5 text-red-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <strong>Transaction${indexText} failed</strong>
                    </div>
                    <p class="text-sm">${displayError}</p>
                </div>
            `;
            resultDiv.classList.remove('hidden');
        }

        // Simulation toggle
        function toggleSimulation() {
            simulationEnabled = !simulationEnabled;
            const track = document.getElementById('toggle-track');
            const knob = document.getElementById('toggle-knob');
            if (simulationEnabled) {
                track.classList.remove('bg-slate-600');
                track.classList.add('bg-emerald-500');
                knob.classList.remove('bg-slate-400', 'left-0.5');
                knob.classList.add('bg-white', 'left-6');
            } else {
                track.classList.remove('bg-emerald-500');
                track.classList.add('bg-slate-600');
                knob.classList.remove('bg-white', 'left-6');
                knob.classList.add('bg-slate-400', 'left-0.5');
            }
        }

        // Set example in the form
        function setExample(text) {
            document.getElementById('prompt-input').value = text;
            document.getElementById('prompt-input').focus();
        }

        // Copy to clipboard function
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            navigator.clipboard.writeText(text).then(() => {
                // Show feedback
                const button = element.parentNode.querySelector('button');
                const originalHTML = button.innerHTML;
                button.innerHTML = '<svg class="w-4 h-4 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>';
                setTimeout(() => {
                    button.innerHTML = originalHTML;
                }, 1000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
            });
        }

        // Build transaction via API
        async function buildTransaction() {
            const promptInput = document.getElementById('prompt-input');
            const payerInput = document.getElementById('payer-input');
            const outputDiv = document.getElementById('demo-output');
            const buildBtn = document.getElementById('build-btn');
            const signBtn = document.getElementById('sign-send-btn');
            const resultDiv = document.getElementById('transaction-result');
            const previewDiv = document.getElementById('transaction-preview');
            
            const prompt = promptInput.value.trim();
            const payer = payerInput.value.trim();
            
            if (!prompt) {
                outputDiv.textContent = 'Please enter a natural language prompt.';
                outputDiv.classList.add('text-red-400');
                return;
            }

            // Hide previous results
            signBtn.classList.add('hidden');
            resultDiv.classList.add('hidden');
            previewDiv.classList.add('hidden');
            lastTransactionData = null;
            
            // Show loading state
            buildBtn.disabled = true;
            buildBtn.textContent = 'Building...';
            outputDiv.textContent = 'Building transaction...';
            outputDiv.classList.remove('text-red-400');
            outputDiv.classList.add('text-emerald-400');
            
            try {
                const requestBody = {
                    prompt: prompt
                };
                
                // Add payer (use a demo address if empty)
                requestBody.payer = payer || '11111111111111111111111111111111';
                requestBody.skipSimulation = !simulationEnabled;
                
                const response = await fetch('/api/build/natural', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });
                
                const data = await response.json();
                
                // Handle multi-transaction responses
                if (response.ok && data.success && data.multi && data.transactions) {
                    showMultiTransactionPreview(data);
                    outputDiv.textContent = JSON.stringify(data, null, 2);
                    outputDiv.classList.add('text-slate-300');
                    
                    // Show Sign & Send All button for multi-transaction responses
                    if (connectedWallet) {
                        lastTransactionData = data;
                        showMultiTransactionButtons();
                    }
                } else if (response.ok && data.success && data.details && data.details.parsedIntent) {
                    // Single transaction preview
                    showTransactionPreview(data.details);
                    outputDiv.textContent = JSON.stringify(data, null, 2);
                    outputDiv.classList.add('text-slate-300');
                    
                    // Show Sign & Send button for single transactions
                    if (data.transaction && connectedWallet) {
                        lastTransactionData = data;
                        signBtn.classList.remove('hidden');
                    }
                } else if (!response.ok && data.error) {
                    // Format error with suggestions
                    let errorDisplay = `‚ùå Error: ${data.error}\n\n`;
                    if (data.suggestions && Array.isArray(data.suggestions) && data.suggestions.length > 0) {
                        errorDisplay += `üí° Suggestions:\n`;
                        data.suggestions.forEach(suggestion => {
                            errorDisplay += `  ‚Ä¢ ${suggestion}\n`;
                        });
                        errorDisplay += '\n';
                    }
                    errorDisplay += `Full response:\n${JSON.stringify(data, null, 2)}`;
                    outputDiv.textContent = errorDisplay;
                    outputDiv.classList.add('text-red-400');
                } else {
                    // Normal success response
                    outputDiv.textContent = JSON.stringify(data, null, 2);
                    outputDiv.classList.add('text-slate-300');
                }
                outputDiv.classList.remove('text-emerald-400');
                
            } catch (error) {
                console.error('API Error:', error);
                outputDiv.textContent = `Error: ${error.message}\n\nThis demo requires the SolForge API to be running. Make sure you've started the server with 'npm run dev' or 'npm start'.`;
                outputDiv.classList.add('text-red-400');
            } finally {
                // Reset button state
                buildBtn.disabled = false;
                buildBtn.textContent = 'Build Transaction';
            }
        }

        // Show transaction preview card
        function showTransactionPreview(details) {
            const previewDiv = document.getElementById('transaction-preview');
            const parsedIntent = details.parsedIntent;
            const protocol = details.protocol || parsedIntent.protocol;
            const action = parsedIntent.action;
            const params = parsedIntent.params;
            const confidence = details.confidence || parsedIntent.confidence;
            const resolvedDex = details.resolvedDex;
            
            let previewHTML = '';
            let icon = '';
            let title = '';
            let rows = [];
            
            // Generate preview based on action type
            if (action === 'swap' || action === 'buy' || action === 'sell' || protocol === 'jupiter' || resolvedDex) {
                icon = 'üí±';
                title = 'Swap Transaction';
                
                const fromToken = formatTokenSymbol(params.from);
                const toToken = formatTokenSymbol(params.to);
                const amount = formatAmount(params.amount);
                const displayProtocol = resolvedDex ? `Jupiter (via ${capitalizeProtocol(resolvedDex)})` : capitalizeProtocol(protocol);
                
                rows = [
                    `From: ${amount} ${fromToken} ‚Üí To: ${toToken}`,
                    `Protocol: ${displayProtocol}`,
                    params.slippage ? `Slippage: ${params.slippage}%` : null,
                    confidence ? `Confidence: ${Math.round(confidence * 100)}%` : null
                ].filter(Boolean);
                
            } else if (action === 'memo') {
                icon = 'üìù';
                title = 'Memo Transaction';
                rows = [
                    `Message: "${params.message}"`,
                    'Protocol: Memo Program'
                ];
                
            } else if (action === 'stake' && (protocol === 'marinade' || params.protocol === 'marinade')) {
                icon = 'ü•©';
                title = 'Liquid Staking';
                rows = [
                    `Amount: ${formatAmount(params.amount)} SOL ‚Üí mSOL`,
                    'Protocol: Marinade'
                ];
                
            } else if (action === 'transfer') {
                icon = 'üí∏';
                title = 'SOL Transfer';
                rows = [
                    `Amount: ${formatAmount(params.amount)} SOL`,
                    `To: ${formatAddress(params.to)}`
                ];
                
            } else {
                // Generic fallback
                icon = '‚ö°';
                title = `${capitalizeProtocol(action)} Transaction`;
                rows = [
                    `Protocol: ${capitalizeProtocol(protocol)}`,
                    confidence ? `Confidence: ${Math.round(confidence * 100)}%` : null
                ].filter(Boolean);
            }
            
            previewHTML = `
                <div class="flex items-center mb-4">
                    <div class="text-2xl mr-3">${icon}</div>
                    <div>
                        <h3 class="text-lg font-semibold text-white">${title}</h3>
                        <div class="flex items-center">
                            <div class="w-2 h-2 bg-emerald-400 rounded-full mr-2"></div>
                            <span class="text-emerald-400 text-sm font-medium">Successfully built</span>
                        </div>
                    </div>
                </div>
                <div class="grid gap-2">
                    ${rows.map(row => `<div class="text-slate-300 text-sm">${row}</div>`).join('')}
                </div>
            `;
            
            previewDiv.innerHTML = previewHTML;
            previewDiv.classList.remove('hidden');
        }
        
        // Show multi-transaction preview
        function showMultiTransactionPreview(data) {
            const previewDiv = document.getElementById('transaction-preview');
            const transactions = data.transactions || [];
            const summary = data.summary || `${transactions.length} transactions`;
            
            let previewHTML = `
                <div class="flex items-center mb-4">
                    <div class="text-2xl mr-3">‚ö°</div>
                    <div>
                        <h3 class="text-lg font-semibold text-white">Multi-Transaction Chain</h3>
                        <div class="flex items-center">
                            <div class="w-2 h-2 bg-emerald-400 rounded-full mr-2"></div>
                            <span class="text-emerald-400 text-sm font-medium">${summary}</span>
                        </div>
                    </div>
                </div>
                <div class="space-y-3">
            `;
            
            transactions.forEach((tx, index) => {
                const details = tx.details;
                const action = details.action || details.parsedIntent?.action || 'operation';
                const protocol = details.protocol;
                
                let icon = '‚ö°';
                let description = `${capitalizeProtocol(action)} on ${capitalizeProtocol(protocol)}`;
                
                // Customize based on action
                if (action === 'swap' || action === 'buy' || action === 'sell') {
                    icon = 'üí±';
                    const parsedIntent = details.parsedIntent;
                    if (parsedIntent && parsedIntent.params) {
                        const fromToken = formatTokenSymbol(parsedIntent.params.from || parsedIntent.params.token);
                        const toToken = formatTokenSymbol(parsedIntent.params.to || 'SOL');
                        const amount = formatAmount(parsedIntent.params.amount);
                        description = `${action} ${amount} ${fromToken} ‚Üí ${toToken}`;
                    }
                } else if (action === 'memo') {
                    icon = 'üìù';
                    const parsedIntent = details.parsedIntent;
                    if (parsedIntent && parsedIntent.params && parsedIntent.params.message) {
                        description = `Write memo: "${parsedIntent.params.message}"`;
                    }
                } else if (action === 'transfer') {
                    icon = 'üí∏';
                    const parsedIntent = details.parsedIntent;
                    if (parsedIntent && parsedIntent.params) {
                        const amount = formatAmount(parsedIntent.params.amount);
                        const token = parsedIntent.params.token === 'So11111111111111111111111111111111111111112' ? 'SOL' : parsedIntent.params.token;
                        description = `Transfer ${amount} ${token}`;
                    }
                } else if (action === 'stake') {
                    icon = 'ü•©';
                    const parsedIntent = details.parsedIntent;
                    if (parsedIntent && parsedIntent.params) {
                        const amount = formatAmount(parsedIntent.params.amount);
                        description = `Stake ${amount} SOL`;
                    }
                } else if (action === 'tip') {
                    icon = 'üíé';
                    const parsedIntent = details.parsedIntent;
                    if (parsedIntent && parsedIntent.params) {
                        const amount = formatAmount(parsedIntent.params.amount);
                        description = `Tip ${amount} SOL to Jito`;
                    }
                }
                
                previewHTML += `
                    <div class="flex items-center p-3 bg-slate-800/50 rounded-lg">
                        <span class="text-lg mr-3">${icon}</span>
                        <div class="flex-1">
                            <span class="text-white text-sm font-medium">${index + 1}. ${description}</span>
                            <div class="text-slate-400 text-xs mt-1">${capitalizeProtocol(protocol)}</div>
                        </div>
                        <div class="w-2 h-2 bg-emerald-400 rounded-full"></div>
                    </div>
                `;
            });
            
            previewHTML += '</div>';
            
            previewDiv.innerHTML = previewHTML;
            previewDiv.classList.remove('hidden');
        }
        
        // Show multi-transaction buttons
        function showMultiTransactionButtons() {
            const signBtn = document.getElementById('sign-send-btn');
            const resultDiv = document.getElementById('transaction-result');
            
            // Hide the single transaction button
            signBtn.classList.add('hidden');
            
            // Create multi-transaction buttons if not already present
            let multiButtonsDiv = document.getElementById('multi-transaction-buttons');
            if (!multiButtonsDiv) {
                multiButtonsDiv = document.createElement('div');
                multiButtonsDiv.id = 'multi-transaction-buttons';
                multiButtonsDiv.className = 'space-y-3 mt-4';
                signBtn.parentNode.insertBefore(multiButtonsDiv, signBtn.nextSibling);
            }
            
            const transactions = lastTransactionData.transactions || [];
            const summary = lastTransactionData.summary || `${transactions.length} transactions`;
            
            multiButtonsDiv.innerHTML = `
                <button id="sign-send-all-btn" class="w-full py-4 bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white font-semibold rounded-xl transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-amber-500/25 flex items-center justify-center" onclick="signAndSendAllTransactions()">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Sign & Send All (${transactions.length} transactions)
                </button>
                <div class="text-center text-slate-400 text-sm">
                    ${summary}
                </div>
                <div class="space-y-2" id="individual-transaction-buttons">
                    ${transactions.map((tx, index) => {
                        const action = tx.details.action || tx.details.parsedIntent?.action || 'operation';
                        return `
                            <button class="w-full py-2 bg-slate-700 hover:bg-slate-600 text-white text-sm rounded-lg transition-all duration-200 flex items-center justify-center" onclick="signAndSendTransaction(${index})">
                                ${index + 1}. Sign & Send ${capitalizeProtocol(action)}
                            </button>
                        `;
                    }).join('')}
                </div>
            `;
            
            multiButtonsDiv.classList.remove('hidden');
        }

        // Helper functions for formatting
        function formatTokenSymbol(address) {
            const tokenMap = {
                'So11111111111111111111111111111111111111112': 'SOL',
                'EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v': 'USDC',
                'Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB': 'USDT',
                'DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263': 'BONK'
            };
            return tokenMap[address] || (address && address.length > 10 ? `${address.slice(0, 4)}...${address.slice(-4)}` : address);
        }
        
        function formatAmount(amount) {
            if (typeof amount === 'number') {
                return amount % 1 === 0 ? amount.toString() : amount.toFixed(6).replace(/\.?0+$/, '');
            }
            return amount;
        }
        
        function formatAddress(address) {
            if (!address || address.length < 10) return address;
            return `${address.slice(0, 4)}...${address.slice(-4)}`;
        }
        
        function capitalizeProtocol(protocol) {
            if (!protocol) return '';
            const protocolMap = {
                'jupiter': 'Jupiter',
                'raydium': 'Raydium',
                'orca': 'Orca',
                'marinade': 'Marinade',
                'pumpfun': 'Pump.fun',
                'meteora': 'Meteora',
                'memo': 'Memo',
                'system': 'System',
                'spl-token': 'SPL Token'
            };
            return protocolMap[protocol.toLowerCase()] || protocol.charAt(0).toUpperCase() + protocol.slice(1);
        }
        
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Handle Enter key in prompt input
        document.getElementById('prompt-input').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
                buildTransaction();
            }
        });
        
        // Auto-resize textarea
        const textarea = document.getElementById('prompt-input');
        textarea.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = this.scrollHeight + 'px';
        });

        // Check for wallet on page load
        window.addEventListener('load', function() {
            if (!window.phantom?.solana && !window.solana) {
                document.getElementById('wallet-not-found').classList.remove('hidden');
            }
        });
    </script>
</body>
</html>